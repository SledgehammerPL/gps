{% load l10n %}
{% load static %}
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>GPS Analysis - Live Heatmap Pro</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="{% static 'gps/css/map.css' %}">
</head>
<body>

<div id="main">
    <div id="map"></div>
    <div id="sidebar">
        <h3 style="margin-top:0; color:#555; display:flex; justify-content: space-between; align-items: center;">
            ZAWODNICY 
            <button onclick="selectPlayer(null)" style="font-size:10px; padding:4px 8px;">WSZYSCY</button>
        </h3>
        <div id="player-list"></div>
    </div>
</div>

<div class="controls">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
        <div class="time-display" id="time-val">00:00:00.0</div>
        <div style="display:flex; gap:10px; align-items:center;">
            <button onclick="toggleHeat()" id="heatBtn" class="btn-heat">HEATMAPA: OFF</button>
            <select id="speed" style="background:#333; color:white; border:1px solid #444; padding:8px; border-radius:5px;">
                <option value="1">1x</option><option value="5">5x</option><option value="10">10x</option>
            </select>
            <button onclick="togglePlay()" id="btnPlay">ODTWÃ“RZ</button>
        </div>
    </div>
    <div id="match-info" style="font-size:12px;color:#aaa;margin-bottom:8px;">
        {% if match_id %}
            Mecz: {{ match_date }} {% if base_mac %}| Baza: {{ base_mac }}{% endif %}
        {% else %}
            Brak filtra meczu (ostatnie 24h)
        {% endif %}
    </div>
    <input type="range" id="timeline" min="0" value="0">
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://leaflet.github.io/Leaflet.heat/dist/leaflet-heat.js"></script>

<script>
    // Pass Django variables to JavaScript
    window.matchId = {{ match_id|default:"null" }};
    window.matchDate = "{{ match_date|default:"" }}";
    window.baseMac = "{{ base_mac|default:"" }}";
    window.baseLatitude = {{ base_latitude|unlocalize|default:"null" }};
    window.baseLongitude = {{ base_longitude|unlocalize|default:"null" }};
    window.gpsHistoryUrl = '{% url "gps:gps_history" %}';
    window.updateBaseCoordsUrl = '{% url "gps:update_base_coords" %}';
</script>
<script src="{% static 'gps/js/map.js' %}"></script>
</body>
</html>
